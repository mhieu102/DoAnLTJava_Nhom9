<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head>
    <!-- Basic -->
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- Mobile Metas -->
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <!-- Site Metas -->
    <meta name="keywords" content="" />
    <meta name="description" content="" />
    <meta name="author" content="" />
    <link rel="shortcut icon" th:href="@{/images/favicon.png}" type="" />
    <title> List Stories </title>

    <!-- bootstrap core css -->
    <link rel="stylesheet" type="text/css" th:href="@{/css/bootstrap.css}" />
    <!--owl slider stylesheet -->
    <link rel="stylesheet" type="text/css" th:href="@{https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/assets/owl.carousel.min.css}" />
    <!-- nice select  -->
    <link rel="stylesheet" th:href="@{https://cdnjs.cloudflare.com/ajax/libs/jquery-nice-select/1.1.0/css/nice-select.min.css}" integrity="sha512-CruCP+TD3yXzlvvijET8wV5WxxEh5H8P4cmz0RFbKK6FlZ2sYl3AEsKlLPHbniXKSrDdFewhbmBK5skbdsASbQ==" crossorigin="anonymous" />
    <!-- font awesome style -->
    <link th:href="@{/css/font-awesome.min.css}" rel="stylesheet" />
    <!-- Custom styles for this template -->
    <link th:href="@{/css/style.css}" rel="stylesheet" />
    <!-- responsive style -->
    <link th:href="@{/css/responsive.css}" rel="stylesheet" />
</head>
<body>
<th:block th:replace="layout::header"></th:block>

<div class="container">
    <h1 th:text="${title}"></h1>
    <table class="table">
        <tr>
            <th>ID</th>
            <th>Tên Truyện</th>
            <th>Tác Giả</th>
            <th>Nhà Xuất Bản</th>
            <th>Giá Tiền</th>
            <th>Số Lượng Kho</th>
            <th>Thể Loại</th>
            <th >Chức Năng</th>
        </tr>
        <tr th:each="truyen: ${truyens}">
            <td th:text="${truyen.id}"></td>
            <td th:text="${truyen.tentruyen}"></td>
            <td th:text="${truyen.nhaxuatban}"></td>
            <td th:text="${truyen.tacgia}"></td>
            <td th:text="${truyen.gia}"></td>
            <td th:text="${truyen.slkho}"></td>
            <td th:text="${truyen.theloai.tentheloai}"></td>
            <td >
                <a th:href="@{/truyens/edit/{id}(id=${truyen.id})}">Sửa</a> |
                <a th:href="@{/truyens/delete/{id}(id=${truyen.id})}" onclick="deleteTruyen(this); return false" class="text-danger">Xóa</a>
            </td>
        </tr>
    </table>
    <a href="/truyens/add">Add Truyện</a>
</div>
<script th:src="@{/js/jquery-3.4.1.min.js}"></script>
<script th:inline="javascript">
    function deleteTruyen(link){
        if(confirm('Bạn có chắc chắn muốn xoá truyện này?')){
        $.ajax({
            url: $(link).attr('href'),
            type: 'DELETE',
            success: result => {
                if (!result.success){
                    alert(result.message);
                }else{
                    $(link).parent().parent().remove();
                }

            }
        });
        }
    }
</script>

<th:block th:replace="layout::footer"></th:block>

<!-- popper js -->
<script th:src="@{https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js}" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
<!-- bootstrap js -->
<script th:src="@{/js/bootstrap.js}"></script>
<!-- owl slider -->
<script th:src="@{https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/owl.carousel.min.js}"></script>
<!-- isotope js -->
<script th:src="@{https://unpkg.com/isotope-layout@3.0.4/dist/isotope.pkgd.min.js}"></script>
<!-- nice select -->
<script th:src="@{https://cdnjs.cloudflare.com/ajax/libs/jquery-nice-select/1.1.0/js/jquery.nice-select.min.js}"></script>
<!-- custom js -->
<script th:src="@{/js/custom.js}"></script>
<!-- Google Map -->
<script th:src="@{https://maps.googleapis.com/maps/api/js?key=AIzaSyCh39n5U-4IoWpsVGUHWdqB6puEkhRLdmI&callback=myMap}"></script>
<!-- End Google Map -->
</body>
</html>